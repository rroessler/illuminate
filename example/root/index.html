<!DOCTYPE html>

<html data-preload-illuminate>
    <head>
        <!-- MISC -->
        <meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
        <meta content="width=device-width" name="viewport" />

        <!-- TITLE -->
        <title>Illuminate - Home</title>

        <!-- ICONS -->
        <link
            href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css"
            rel="stylesheet"
        />

        <!-- STYLESHEETS -->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/default.min.css" />
        <link href="dist/illuminate.min.css" rel="stylesheet" />
        <link href="hljs.css" rel="stylesheet" />
        <link href="overrides.css" rel="stylesheet" />

        <!-- LIBRARIES -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script>
        <script src="dist/illuminate.js"></script>
    </head>

    <body>
        <!-- PAGE WRAPPER -->
        <div class="page-wrapper with-navbar with-sidebar" data-sidebar-state="open">
            <!-- NAVBAR -->
            <div class="navbar">
                <div class="section">
                    <button class="btn btn-sm btn-action" type="button" onclick="Illuminate.Sidebar.toggle();">
                        <i aria-hidden="true" class="las la-lg la-bars"></i>
                    </button>
                </div>

                <a class="brand ml-xs-auto ml-sm-15" href="/">
                    <i class="las la-lg la-sun text-secondary"></i>&nbsp;Illuminate
                </a>

                <div class="section ml-auto d-none d-sm-block">
                    <button class="btn btn-sm btn-action" type="button">
                        <i aria-hidden="true" class="lab la-lg la-github"></i>
                    </button>

                    <button class="btn btn-sm btn-action" type="button" onclick="Illuminate.Theme.toggle();">
                        <i aria-hidden="true" class="las la-lg la-tint"></i>
                    </button>

                    <button class="btn btn-sm btn-info" type="button">Download</button>
                </div>
            </div>

            <!-- SIDEBAR -->
            <div class="sidebar">
                <div class="menu">
                    <h5 class="title">Elements</h5>
                    <div class="divider"></div>

                    <a class="link" href="#elements/buttons">Buttons</a>
                    <a class="link" href="#elements/code">Code</a>
                    <a class="link" href="#elements/image">Image</a>
                    <a class="link" href="#elements/links">Links</a>
                    <a class="link" href="#elements/tables">Tables</a>
                </div>

                <div class="menu mt-auto">
                    <div class="divider"></div>
                    <a class="link" href="#settings">Settings</a>
                </div>
            </div>

            <!-- CONTENT WRAPPER -->
            <div class="content-wrapper p-20">
                <h1 id="content-title">...</h1>
                <div class="divider my-15"></div>

                <div id="content-body"></div>
            </div>
        </div>

        <script>
            /// Loads a code block.
            const loadCode = (() => {
                // sanitizable items
                const santizable = [[/&/g, '&amp;']];

                // code loader
                return (block) => {
                    // retrieve the required text
                    let text = block.prev().text().split(/\r?\n/);

                    // and modify for suitable display
                    text = text.reduce(
                        (acc, line, ii) => {
                            // get the current spaces on the left
                            const left = line.length - line.trimLeft().length;

                            // trim as necessary if left is less than current spaces
                            if (left < acc.spaces && ii > 0 && line.length > 0) acc.spaces = left;

                            // remove the front of the string
                            acc.value += `${line.substr(acc.spaces)}\n`;

                            // return the result
                            return acc;
                        },
                        { value: '', spaces: Infinity }
                    );

                    // remove the ending and starting "\n" characters
                    text.value = text.value.substr(1, text.value.length - 2);

                    // convert the current block into suitable display
                    const language = block.attr('data-language');
                    const code = hljs.highlight(text.value, { language }).value;

                    // construct and append each required item
                    const pre = $.create('pre', {
                        className: 'm-0',
                        innerHTML: `<code class="ignore-style">${code}</code>`
                    });

                    const copy = $.create('button', {
                        className: 'btn btn-sm btn-inverted copy-button',
                        innerHTML: '<i class="las la-lg la-copy"></i>&nbsp;Copy',
                        onclick: () => navigator.clipboard.writeText(text.value)
                    });

                    block.append(pre, copy);
                };
            })();

            /// Coordinates updating the current route.
            const updateRoute = async () => {
                const hash = encodeURIComponent(window.location.hash.substring(1));
                const title = hash.includes('%2F') ? hash.substr(hash.lastIndexOf('%2F') + 3) : hash;
                const content = await fetch(`docs/${hash}`, { method: 'GET' }).then((res) => res.text());

                $('#content-title').text(title[0].toUpperCase() + title.substring(1));
                $('#content-body').text(content);

                // once complete, load in any CODE to display
                const blocks = $.all('.code-container', $('#content-body'));
                blocks.map((block) => loadCode(block));
            };

            // pre-emptively update the route
            updateRoute();

            // and update whenever it changes
            window.onhashchange = updateRoute;
        </script>
    </body>
</html>
